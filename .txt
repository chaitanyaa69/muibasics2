import React, { useState } from 'react';
import { Box, List, ListItem, ListItemButton, ListItemText, useTheme, Avatar, Typography, CircularProgress, Drawer, useMediaQuery, IconButton, Divider } from '@mui/material';
import MenuIcon from '@mui/icons-material/Menu';
import SettingsOutlinedIcon from '@mui/icons-material/SettingsOutlined';
import EmailOutlinedIcon from '@mui/icons-material/EmailOutlined';
import PhoneOutlinedIcon from '@mui/icons-material/PhoneOutlined';
import LockOutlinedIcon from '@mui/icons-material/LockOutlined';
import PermIdentityOutlinedIcon from '@mui/icons-material/PermIdentityOutlined';
import PaidOutlinedIcon from '@mui/icons-material/PaidOutlined';
import StarsOutlinedIcon from '@mui/icons-material/StarsOutlined';
import DescriptionOutlinedIcon from '@mui/icons-material/DescriptionOutlined';
import FormatListBulletedOutlinedIcon from '@mui/icons-material/FormatListBulletedOutlined';
import KeyboardArrowRightOutlinedIcon from '@mui/icons-material/KeyboardArrowRightOutlined';
import { useNavigate } from 'react-router-dom';
import { useDispatch, useSelector } from 'react-redux';
import { logout, selectUser } from '../../Features/UserSice';
import trustrLogo from '../../Assets/img/trustr.png'; // Adjust the path to the actual location of your image
import {Sidebar,Menu,MenuItem} from "react-pro-sidebar";
import "react-pro-sidebar/dist/css/styles.css";
import { tokens } from '../../theme';

const DrawerContent = ({ email }) => {
  const navigate = useNavigate();
  const user = useSelector(selectUser);
  const dispatch = useDispatch();
  const [loading, setLoading] = useState(false);
  const [mobileOpen, setMobileOpen] = useState(false);
  const theme = useTheme();
  const colors= tokens(theme.palette.mode)
  const [selected,setSelected]= useState(false)
  const handleDrawerToggle = () => {
    setMobileOpen(!mobileOpen);
  };

  const handleLogout = (e) => {
    e.preventDefault();
    setLoading(true);
    setTimeout(() => {
      localStorage.removeItem('token');
      dispatch(logout());
      navigate('/');
      setLoading(false);
    }, 2000);
  };

  const listItemStyle = {
    color: '#C1C1C1',
    transition: 'transform 0.3s ease-in-out',
    position: 'relative',
    '&:hover': {
      transform: 'scale(1.049)',
      backgroundColor: '#6131F8',
      color: 'white',
      '& .MuiSvgIcon-root': {
        color: 'white',
      },
      '& .arrow-icon': {
        opacity: 1,
        transform: 'translateX(0)',
      },
    },
    mb: '0.1rem',
    borderRadius: '0.5rem',
    padding: '6px 8px',
    fontSize: '0.875rem',
    '& .arrow-icon': {
      opacity: 0,
      transform: 'translateX(-10px)',
      transition: 'opacity 0.3s ease-in-out, transform 0.3s ease-in-out',
    },
  };

  const listItemStyleStatic = {
    width: '100%',
    padding: '6px 8px',
    color: '#c1c1c1',
    transition: 'transform 0.3s ease-in-out',
    mb: '0.01rem',
    borderRadius: '0.5rem',
    fontSize: '0.875rem',
    '&:hover': {
      transform: 'scale(1.049)',
      backgroundColor: '#6131F8',
      color: 'white',
      '& .MuiSvgIcon-root': {
        color: 'white',
      },
    },
  };

  let fullName = user?.user?.name;

  function getFirstName(fullName){
    if (!fullName) {
      return 'Guest'; // Default value if fullName is undefined
    }
    let nameParts = fullName.split('');
    let firstName = nameParts[0];
    return firstName.charAt(0).toUpperCase() + firstName.slice(1).toLowerCase();
  }

  let firstName = getFirstName(fullName);

  const userPhoneNumber = "+91-7778889999"; // Replace this with the actual phone number from your login logic

  const drawerContent = (
    <Box sx={{ 
          "& .pro-sdiebar-inner" : {
            background : `${colors.primary[400]}`
          },
          width: '270px', backgroundColor: '#000A3E', color: 'white', height: '100vh', padding: '0.9rem', display: 'flex', flexDirection: 'column', justifyContent: 'space-between', mt: 0 }}>
      <Box>
      <Box sx={{ display: 'flex',justifyContent:'between', alignItems: 'center', mb: '1rem' }}>
          <Box sx={{ backgroundColor: 'white', padding: '10px', borderRadius: '0.6rem' }}>
            <img src={trustrLogo} alt="Trustr Logo" style={{ width: '30px', height: '30px' }} />
          </Box>
          <Typography variant="h6" sx={{ ml: 2, fontWeight: 'bold', color: 'white',fontSize:'2rem', fontStretch:'expanded' }}>
            Trustr
          </Typography>
        </Box>
        <Divider sx={{bgcolor:'grey.500'}}/>
        <List>
         <ListItemButton onClick={() => navigate('/profile')} sx={listItemStyle}>
            <PermIdentityOutlinedIcon sx={{ mr: 2, fontSize: '1.25rem' }} />
            <ListItemText primary="Profile" />
            <KeyboardArrowRightOutlinedIcon className="arrow-icon" sx={{ fontSize: 20 }} />
          </ListItemButton>
          <ListItemButton onClick={() => navigate('/settings')} sx={listItemStyle}>
            <LockOutlinedIcon sx={{ mr: 2, fontSize: '1.25rem' }} />
            <ListItemText primary="Password" />
            <KeyboardArrowRightOutlinedIcon className="arrow-icon" sx={{ fontSize: 20 }} />
          </ListItemButton>
          <ListItemButton onClick={() => navigate('/settings')} sx={listItemStyle}>
            <SettingsOutlinedIcon sx={{ mr: 2, fontSize: '1.25rem' }} />
            <ListItemText primary="Preferences" />
            <KeyboardArrowRightOutlinedIcon className="arrow-icon" sx={{ fontSize: 20 }} />
          </ListItemButton>
          <ListItemButton onClick={() => navigate('/settings')} sx={listItemStyle}>
            <PaidOutlinedIcon sx={{ mr: 2, fontSize: '1.25rem' }} />
            <ListItemText primary="Payments" />
            <KeyboardArrowRightOutlinedIcon className="arrow-icon" sx={{ fontSize: 20 }} />
          </ListItemButton>
          <ListItemButton onClick={() => navigate('/settings')} sx={listItemStyle}>
            <StarsOutlinedIcon sx={{ mr: 2, fontSize: '1.25rem' }} />
            <ListItemText primary="Check Call Quality" />
            <KeyboardArrowRightOutlinedIcon className="arrow-icon" sx={{ fontSize: 20 }} />
          </ListItemButton>
          <ListItemButton onClick={() => navigate('/settings')} sx={listItemStyle}>
            <DescriptionOutlinedIcon sx={{ mr: 2, fontSize: '1.25rem' }} />
            <ListItemText primary="Documents" />
            <KeyboardArrowRightOutlinedIcon className="arrow-icon" sx={{ fontSize: 20 }} />
          </ListItemButton>
          <ListItemButton onClick={() => navigate('/settings')} sx={listItemStyle}>
            <FormatListBulletedOutlinedIcon sx={{ mr: 2, fontSize: '1.25rem' }} />
            <ListItemText primary="Logs" />
            <KeyboardArrowRightOutlinedIcon className="arrow-icon" sx={{ fontSize: 20 }} />
          </ListItemButton>
          <ListItemButton onClick={() => navigate('/settings')} sx={listItemStyle}>
            <ListItemText primary="Support" />
            <KeyboardArrowRightOutlinedIcon className="arrow-icon" sx={{ fontSize: 20 }} />
          </ListItemButton>
          <ListItemButton onClick={() => navigate('/settings')} sx={listItemStyle}>
            <ListItemText primary="Terms" />
            <KeyboardArrowRightOutlinedIcon className="arrow-icon" sx={{ fontSize: 20 }} />
          </ListItemButton>
          <ListItemButton onClick={() => navigate('/settings')} sx={listItemStyle}>
            <ListItemText primary="Privacy and Procedures" />
            <KeyboardArrowRightOutlinedIcon className="arrow-icon" sx={{ fontSize: 20 }} />
          </ListItemButton>
        </List>
      </Box>
      <Box>
        <Divider sx={{ bgcolor: 'grey.500' }} />
        <ListItemButton
          onClick={handleLogout}
          sx={{
            ...listItemStyle,
            '&:hover': {
              ...listItemStyle['&:hover'],
              '& .MuiSvgIcon-root': {
                color: 'red',
              },
            },
          }}
        >
          {loading ? (
            <Box display="flex" justifyContent="center" alignItems="center" width="100%">
              <CircularProgress size={24} sx={{ color: 'white' }} />
            </Box>
          ) : (
            <ListItemText primary="Logout" sx={{ textAlign: 'center', color: '#FA6666' }} />
          )}
        </ListItemButton>
      </Box>
    </Box>
  );

  return (
    <Box sx={{ display: 'flex' }}>
      <IconButton
        color="inherit"
        aria-label="open drawer"
        edge="start"
        onClick={handleDrawerToggle}
      >
        <MenuIcon />
      </IconButton>
      <Box component="main" sx={{ flexGrow: 1, p: 3 }}>
        {/* Your main content here */}
      </Box>
    </Box>
  );
};
export default DrawerContent;
